Loading eggNOG CSV data...
  Total eggNOG records loaded: 139886438
Filtering eggNOG records for COG/arCOG entries...
  Records after filtering: 139886438
Pivoting eggNOG data to build a gene count table per accession...
  Pivoted gene count table shape: (113102, 12874)
Loading archaeal metadata...
  Archaeal metadata records: 12477
Loading bacterial metadata...
  Bacterial metadata records: 584382
Selecting key metadata columns...
Combining archaeal and bacterial metadata...
Merging gene count table with metadata...
  Merged data shape: (113102, 12880)
Splitting 'gtdb_taxonomy' into taxonomy columns:
  Taxonomy levels: ['domain', 'phylum', 'class', 'order', 'family', 'group', 'species']
  After adding taxonomy columns, data shape is: (113102, 12887)
Created global vocabulary (12873 tokens) and cog2idx mapping.
Data processing complete.
Starting subsample_and_split_by_taxonomy...
  Total genomes before subsampling: 113102
  Subsampling 100.0% of the genomes...
  Genomes after subsampling: 113102
  Found 24959 unique groups at taxonomic level 'group'.
  Target test set size: ~22620 genomes
  Test set: 22625 genomes from 4911 groups; Train set: 90477 genomes
  No overlap in taxonomic groups between train and test sets.
Subsample and split complete.


 Low noise:
  Average per-genome Accuracy         : 0.4906
  Average per-genome Precision (macro)  : 0.0932
  Average per-genome Recall (macro)     : 0.4975
  Average per-genome F1 (macro)         : 0.1545
  Average Genome Size Difference (abs)  : 0.1870
  Average FP Noise Removed Fraction   : 0.4900
  Average FN Noise Recovered Fraction : 0.4979

 Med noise:
  Average per-genome Accuracy         : 0.4909
  Average per-genome Precision (macro)  : 0.0932
  Average per-genome Recall (macro)     : 0.4975
  Average per-genome F1 (macro)         : 0.1546
  Average Genome Size Difference (abs)  : 0.1871
  Average FP Noise Removed Fraction   : 0.4901
  Average FN Noise Recovered Fraction : 0.4973

 High noise:
  Average per-genome Accuracy         : 0.4913
  Average per-genome Precision (macro)  : 0.0933
  Average per-genome Recall (macro)     : 0.4971
  Average per-genome F1 (macro)         : 0.1547
  Average Genome Size Difference (abs)  : 0.1871
  Average FP Noise Removed Fraction   : 0.4904
  Average FN Noise Recovered Fraction : 0.4972
Training on device: cuda
Using standard BCE Loss
